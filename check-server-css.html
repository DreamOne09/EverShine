<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æª¢æŸ¥ä¼ºæœå™¨ CSS æ–‡ä»¶</title>
    <style>
        body {
            background: #000;
            color: #fff;
            padding: 2rem;
            font-family: monospace;
        }
        
        .result {
            background: rgba(0, 100, 200, 0.2);
            border: 2px solid #4ca8df;
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 10px;
        }
        
        .pass { color: #00ff00; }
        .fail { color: #ff0000; }
        .warning { color: #ffaa00; }
        
        button {
            background: #4ca8df;
            color: #fff;
            border: none;
            padding: 1rem 2rem;
            border-radius: 5px;
            cursor: pointer;
            margin: 1rem 0.5rem 1rem 0;
            font-size: 16px;
        }
        
        button:hover {
            background: #78c6fb;
        }
        
        pre {
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem;
            border-radius: 5px;
            overflow-x: auto;
            max-height: 400px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1 style="color: #daa520;">ğŸ” æª¢æŸ¥ä¼ºæœå™¨ CSS æ–‡ä»¶</h1>
    
    <button onclick="checkServerCSS()">ğŸ“¡ æª¢æŸ¥ä¼ºæœå™¨ CSS</button>
    <button onclick="downloadAndCheck()">â¬‡ï¸ ä¸‹è¼‰ä¸¦æª¢æŸ¥</button>
    
    <div class="result">
        <h3>æª¢æŸ¥çµæœï¼š</h3>
        <div id="result">é»æ“ŠæŒ‰éˆ•é–‹å§‹æª¢æŸ¥...</div>
    </div>
    
    <div class="result">
        <h3>CSS æ–‡ä»¶å…§å®¹é è¦½ï¼š</h3>
        <pre id="preview">ç­‰å¾…æª¢æŸ¥...</pre>
    </div>
    
    <script>
        async function checkServerCSS() {
            const resultDiv = document.getElementById('result');
            const previewDiv = document.getElementById('preview');
            
            resultDiv.innerHTML = 'æ­£åœ¨æª¢æŸ¥ä¼ºæœå™¨ CSS...';
            
            try {
                const response = await fetch('css/style.css?v=20251119-CRITICAL-FIX&nocache=' + Date.now());
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const cssText = await response.text();
                const fileSize = cssText.length;
                const lines = cssText.split('\n').length;
                
                // æª¢æŸ¥é—œéµå…§å®¹
                const hasSuccessGrid = cssText.includes('.success-stories-grid');
                const hasSuccessCard = cssText.includes('.success-card-individual');
                const hasGridTemplate = cssText.includes('grid-template-columns: repeat(4, 1fr)');
                const hasBorder3px = cssText.includes('border: 3px solid var(--glass-border)');
                
                // è¨ˆç®— CSS è¦å‰‡æ•¸é‡ï¼ˆç²—ç•¥ä¼°è¨ˆï¼‰
                const ruleCount = (cssText.match(/\{/g) || []).length;
                
                let html = '<h4>ä¼ºæœå™¨ CSS æ–‡ä»¶æª¢æŸ¥ï¼š</h4>';
                html += `<p><strong>æ–‡ä»¶å¤§å°ï¼š</strong> ${fileSize.toLocaleString()} å­—ç¬¦ (${(fileSize/1024).toFixed(2)} KB)</p>`;
                html += `<p><strong>è¡Œæ•¸ï¼š</strong> ${lines.toLocaleString()}</p>`;
                html += `<p><strong>ä¼°è¨ˆè¦å‰‡æ•¸ï¼š</strong> ${ruleCount.toLocaleString()}</p>`;
                
                html += '<hr style="border-color: #4ca8df; margin: 1rem 0;">';
                
                html += '<h4>é—œéµå…§å®¹æª¢æŸ¥ï¼š</h4>';
                html += `<p class="${hasSuccessGrid ? 'pass' : 'fail'}">${hasSuccessGrid ? 'âœ“' : 'âœ—'} .success-stories-grid</p>`;
                html += `<p class="${hasSuccessCard ? 'pass' : 'fail'}">${hasSuccessCard ? 'âœ“' : 'âœ—'} .success-card-individual</p>`;
                html += `<p class="${hasGridTemplate ? 'pass' : 'fail'}">${hasGridTemplate ? 'âœ“' : 'âœ—'} grid-template-columns: repeat(4, 1fr)</p>`;
                html += `<p class="${hasBorder3px ? 'pass' : 'fail'}">${hasBorder3px ? 'âœ“' : 'âœ—'} border: 3px solid var(--glass-border)</p>`;
                
                html += '<hr style="border-color: #4ca8df; margin: 1rem 0;">';
                
                if (fileSize < 50000) {
                    html += '<p class="fail"><strong>âŒ è­¦å‘Šï¼šæ–‡ä»¶å¤ªå°ï¼</strong><br>æ­£å¸¸æ‡‰è©²ç´„ 110-120 KBï¼Œä½†åªæœ‰ ' + (fileSize/1024).toFixed(2) + ' KB</p>';
                    html += '<p class="fail">æ–‡ä»¶å¯èƒ½è¢«æˆªæ–·æˆ–æå£ï¼</p>';
                } else if (ruleCount < 1000) {
                    html += '<p class="warning"><strong>âš ï¸ è­¦å‘Šï¼šCSS è¦å‰‡å¤ªå°‘ï¼</strong><br>æ­£å¸¸æ‡‰è©²ç´„ 3000-5000 æ¢è¦å‰‡ï¼Œä½†åªæª¢æ¸¬åˆ° ' + ruleCount + ' æ¢</p>';
                } else {
                    html += '<p class="pass"><strong>âœ“ æ–‡ä»¶å¤§å°æ­£å¸¸</strong></p>';
                }
                
                if (hasSuccessGrid && hasSuccessCard && hasGridTemplate && hasBorder3px) {
                    html += '<p class="pass"><strong>âœ“ æ‰€æœ‰é—œéµæ¨£å¼éƒ½å­˜åœ¨</strong></p>';
                    html += '<p class="pass">CSS æ–‡ä»¶å…§å®¹å®Œæ•´ï¼å•é¡Œå¯èƒ½åœ¨ç€è¦½å™¨ç«¯ã€‚</p>';
                } else {
                    html += '<p class="fail"><strong>âœ— ç¼ºå°‘é—œéµæ¨£å¼</strong></p>';
                    html += '<p class="fail">CSS æ–‡ä»¶ä¸å®Œæ•´æˆ–æå£ï¼</p>';
                }
                
                resultDiv.innerHTML = html;
                
                // é¡¯ç¤ºæ–‡ä»¶é–‹é ­å’Œé—œéµéƒ¨åˆ†
                const successGridIndex = cssText.indexOf('.success-stories-grid');
                let preview = '=== æ–‡ä»¶é–‹é ­ (å‰ 500 å­—ç¬¦) ===\n\n';
                preview += cssText.substring(0, 500);
                preview += '\n\n...\n\n';
                
                if (successGridIndex > 0) {
                    preview += '=== .success-stories-grid é™„è¿‘ ===\n\n';
                    preview += cssText.substring(Math.max(0, successGridIndex - 100), successGridIndex + 500);
                } else {
                    preview += '=== âŒ æœªæ‰¾åˆ° .success-stories-grid ===';
                }
                
                previewDiv.textContent = preview;
                
            } catch (error) {
                resultDiv.innerHTML = `<p class="fail"><strong>âŒ éŒ¯èª¤ï¼š</strong>${error.message}</p>`;
                console.error('Error fetching CSS:', error);
            }
        }
        
        async function downloadAndCheck() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'æ­£åœ¨ä¸‹è¼‰ä¸¦åˆ†æ CSS æ–‡ä»¶...';
            
            try {
                const response = await fetch('css/style.css?v=20251119-CRITICAL-FIX&download=' + Date.now());
                const cssText = await response.text();
                
                // å‰µå»ºä¸‹è¼‰é€£çµ
                const blob = new Blob([cssText], { type: 'text/css' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'style-downloaded.css';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                resultDiv.innerHTML = '<p class="pass">âœ“ æ–‡ä»¶å·²ä¸‹è¼‰åˆ°æœ¬åœ°ï¼</p><p>è«‹æª¢æŸ¥ä¸‹è¼‰çš„æ–‡ä»¶å¤§å°æ˜¯å¦ç´„ 110-120 KB</p>';
                
            } catch (error) {
                resultDiv.innerHTML = `<p class="fail"><strong>âŒ éŒ¯èª¤ï¼š</strong>${error.message}</p>`;
            }
        }
        
        // è‡ªå‹•åŸ·è¡Œæª¢æŸ¥
        window.addEventListener('DOMContentLoaded', () => {
            setTimeout(checkServerCSS, 500);
        });
    </script>
</body>
</html>

